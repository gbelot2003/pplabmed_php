!function(e){if("undefined"==typeof e)throw Error("jQuery should be loaded before CKEditor jQuery adapter.");if("undefined"==typeof CKEDITOR)throw Error("CKEditor should be loaded before CKEditor jQuery adapter.");CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal||CKEDITOR.config.jqueryOverrideVal,e.extend(e.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return e},ckeditor:function(t,n){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!e.isFunction(t)){var a=n;n=t,t=a}var i=[];n=n||{},this.each(function(){var a=e(this),o=a.data("ckeditorInstance"),r=a.data("_ckeditorInstanceLock"),d=this,s=new e.Deferred;i.push(s.promise()),o&&!r?(t&&t.apply(o,[this]),s.resolve()):r?o.once("instanceReady",function(){setTimeout(function(){o.element?(o.element.$==d&&t&&t.apply(o,[d]),s.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999):((n.autoUpdateElement||"undefined"==typeof n.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(n.autoUpdateElementJquery=!0),n.autoUpdateElement=!1,a.data("_ckeditorInstanceLock",!0),o=e(this).is("textarea")?CKEDITOR.replace(d,n):CKEDITOR.inline(d,n),a.data("ckeditorInstance",o),o.on("instanceReady",function(n){var i=n.editor;setTimeout(function(){if(i.element){if(n.removeListener(),i.on("dataReady",function(){a.trigger("dataReady.ckeditor",[i])}),i.on("setData",function(e){a.trigger("setData.ckeditor",[i,e.data])}),i.on("getData",function(e){a.trigger("getData.ckeditor",[i,e.data])},999),i.on("destroy",function(){a.trigger("destroy.ckeditor",[i])}),i.on("save",function(){return e(d.form).submit(),!1},null,null,20),i.config.autoUpdateElementJquery&&a.is("textarea")&&e(d.form).length){var o=function(){a.ckeditor(function(){i.updateElement()})};e(d.form).submit(o),e(d.form).bind("form-pre-serialize",o),a.bind("destroy.ckeditor",function(){e(d.form).unbind("submit",o),e(d.form).unbind("form-pre-serialize",o)})}i.on("destroy",function(){a.removeData("ckeditorInstance")}),a.removeData("_ckeditorInstanceLock"),a.trigger("instanceReady.ckeditor",[i]),t&&t.apply(i,[d]),s.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999))});var o=new e.Deferred;return this.promise=o.promise(),e.when.apply(this,i).then(function(){o.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(e.fn.val=CKEDITOR.tools.override(e.fn.val,function(t){return function(n){if(arguments.length){var a=this,i=[],o=this.each(function(){var a=e(this),o=a.data("ckeditorInstance");if(a.is("textarea")&&o){var r=new e.Deferred;return o.setData(n,function(){r.resolve()}),i.push(r.promise()),!0}return t.call(a,n)});if(i.length){var r=new e.Deferred;return e.when.apply(this,i).done(function(){r.resolveWith(a)}),r.promise()}return o}var o=e(this).eq(0),d=o.data("ckeditorInstance");return o.is("textarea")&&d?d.getData():t.call(o)}}))}(window.jQuery),function(){function e(e){return items=[10328,10328,10332,10333,10334,10335,10336],!items.includes(e)}function t(e){return!(e.length&&e.length>0)&&(0===e.length||void 0)}function n(e){const t=$("#myForm").serialize();$.ajax({method:"POST",url:"/histipatologiaApi/store",data:t}).done(function(e){toastr.success("La biopsia a sido salvada exitosamente!!","Registro Guardado"),window.location="/histopatologia/ "+Number(e.serial)+"/edit"}).fail(function(e){toastr.error("El servidor dice:  "+e.statusText,"Status: "+e.status+" -- "+e.responseText)})}$.ajaxSetup({headers:{"X-XSRF-TOKEN":$('input[name="_token"]').val()}}),$(document).ready(function(){$(".dateclass").inputmask("##/##/####"),$("#firma2_id").append($("<option>",{value:"none",text:"None",attr:"disabled"})),$("#factura").focus(),$("#factura").focusout(function(){var n=$(this).val();$.get("/facturas/"+n).done(function(n){return t(n)?(alert("no hay datos"),$("#factura").val(""),$("#paciente").val(""),$("#edad").val(""),$("#edad2").val(""),$("#email").val(""),$("#direccion").val(""),$("#sexo").val(""),void $("#medico").val("")):e(n.examen.item)===!1?(""===$("#factura").val(),alert("Esta no es una Biopsia")):($("#paciente").val(n.nombre_completo_cliente),$("#edad").val(n.edad),$("#email").val(n.correo),$("#direccion").val(n.direccion_entrega_sede),$("#sexo").val(n.sexo),void $("#medico").val(n.medico))}).fail(function(){alert("Problemas con el servidor"),$("#factura").val(""),$("#paciente").val(""),$("#edad").val(""),$("#edad2").val(""),$("#email").val(""),$("#direccion").val(""),$("#sexo").val(""),$("#medico").val("")})})}),$("a.bt-insert").click(function(e){e.preventDefault();const t=$(this).attr("href");$.get("/plantillas/info/"+t).done(function(e){CKEDITOR.instances.informe.insertHtml(e.body)})}),$("#ImagesModal").on("shown.bs.modal",function(e){}),$("#topog").inputmask("#99.9"),$("#informe").ckeditor(function(){this.addCommand("myGreetingCommand",{exec:function(e,t){n("inside")}}),this.keystrokeHandler.keystrokes[120]="myGreetingCommand",this.addCommand("myGoodByeCommand",{exec:function(e,t){n("inside!")}}),this.keystrokeHandler.keystrokes[CKEDITOR.CTRL+66]="myGoodByeCommand"}),document.addEventListener("keydown",function(e){120==e.which&&n("outside")}),$("#myForm").submit(function(e){e.preventDefault(),n("outside")})}(jQuery);