{"version":3,"sources":["jqAdapter.js","histopatologia-create.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"histopatologia-create.js","sourcesContent":["/*\r\n Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\r\n For licensing, see LICENSE.md or http://ckeditor.com/license\r\n*/\r\n(function(a){if(\"undefined\"==typeof a)throw Error(\"jQuery should be loaded before CKEditor jQuery adapter.\");if(\"undefined\"==typeof CKEDITOR)throw Error(\"CKEditor should be loaded before CKEditor jQuery adapter.\");CKEDITOR.config.jqueryOverrideVal=\"undefined\"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal;a.extend(a.fn,{ckeditorGet:function(){var a=this.eq(0).data(\"ckeditorInstance\");if(!a)throw\"CKEditor is not initialized yet, use ckeditor() with a callback.\";return a},\r\nckeditor:function(g,d){if(!CKEDITOR.env.isCompatible)throw Error(\"The environment is incompatible.\");if(!a.isFunction(g)){var m=d;d=g;g=m}var k=[];d=d||{};this.each(function(){var b=a(this),c=b.data(\"ckeditorInstance\"),f=b.data(\"_ckeditorInstanceLock\"),h=this,l=new a.Deferred;k.push(l.promise());if(c&&!f)g&&g.apply(c,[this]),l.resolve();else if(f)c.once(\"instanceReady\",function(){setTimeout(function(){c.element?(c.element.$==h&&g&&g.apply(c,[h]),l.resolve()):setTimeout(arguments.callee,100)},0)},\r\nnull,null,9999);else{if(d.autoUpdateElement||\"undefined\"==typeof d.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)d.autoUpdateElementJquery=!0;d.autoUpdateElement=!1;b.data(\"_ckeditorInstanceLock\",!0);c=a(this).is(\"textarea\")?CKEDITOR.replace(h,d):CKEDITOR.inline(h,d);b.data(\"ckeditorInstance\",c);c.on(\"instanceReady\",function(d){var e=d.editor;setTimeout(function(){if(e.element){d.removeListener();e.on(\"dataReady\",function(){b.trigger(\"dataReady.ckeditor\",[e])});e.on(\"setData\",function(a){b.trigger(\"setData.ckeditor\",\r\n[e,a.data])});e.on(\"getData\",function(a){b.trigger(\"getData.ckeditor\",[e,a.data])},999);e.on(\"destroy\",function(){b.trigger(\"destroy.ckeditor\",[e])});e.on(\"save\",function(){a(h.form).submit();return!1},null,null,20);if(e.config.autoUpdateElementJquery&&b.is(\"textarea\")&&a(h.form).length){var c=function(){b.ckeditor(function(){e.updateElement()})};a(h.form).submit(c);a(h.form).bind(\"form-pre-serialize\",c);b.bind(\"destroy.ckeditor\",function(){a(h.form).unbind(\"submit\",c);a(h.form).unbind(\"form-pre-serialize\",\r\nc)})}e.on(\"destroy\",function(){b.removeData(\"ckeditorInstance\")});b.removeData(\"_ckeditorInstanceLock\");b.trigger(\"instanceReady.ckeditor\",[e]);g&&g.apply(e,[h]);l.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999)}});var f=new a.Deferred;this.promise=f.promise();a.when.apply(this,k).then(function(){f.resolve()});this.editor=this.eq(0).data(\"ckeditorInstance\");return this}});CKEDITOR.config.jqueryOverrideVal&&(a.fn.val=CKEDITOR.tools.override(a.fn.val,function(g){return function(d){if(arguments.length){var m=\r\nthis,k=[],f=this.each(function(){var b=a(this),c=b.data(\"ckeditorInstance\");if(b.is(\"textarea\")&&c){var f=new a.Deferred;c.setData(d,function(){f.resolve()});k.push(f.promise());return!0}return g.call(b,d)});if(k.length){var b=new a.Deferred;a.when.apply(this,k).done(function(){b.resolveWith(m)});return b.promise()}return f}var f=a(this).eq(0),c=f.data(\"ckeditorInstance\");return f.is(\"textarea\")&&c?c.getData():g.call(f)}}))})(window.jQuery);","(function () {\r\n    $.ajaxSetup({\r\n        headers: {\r\n            'X-XSRF-TOKEN': $('input[name=\"_token\"]').val()\r\n        }\r\n    });\r\n\r\n    function getDate(date) {\r\n\r\n        const mydate = new Date(date);\r\n        const a = moment(new Date());\r\n        const b = moment(mydate);\r\n        const years = a.diff(b, 'year');\r\n\r\n        b.add(years, 'years');\r\n        const months = a.diff(b, 'months');\r\n        b.add(months, 'months');\r\n        const days = a.diff(b, 'days');\r\n\r\n        if (years > 0) {\r\n            return years + ' A';\r\n        } else {\r\n            return months + ' M';\r\n        }\r\n    }\r\n\r\n    function checkItem(item) {\r\n\r\n        items = [10328, 10328, 10332, 10333, 10334, 10335, 10336, 11576, 11577, 11578, 11579, 11580, 11581, 11582, 11583,11584,\r\n            11585, 11586, 11587, 11588, 11589];\r\n        if (items.includes(item)) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    function isEmptyObject(obj) {\r\n\r\n        if (obj.length && obj.length > 0)\r\n            return false;\r\n\r\n        if (obj.length === 0)\r\n            return true;\r\n    }\r\n\r\n    $(document).ready(function () {\r\n        $('.dateclass').inputmask(\"##/##/####\");\r\n\r\n        $('#firma2_id').append($('<option>', {\r\n            value: 'none',\r\n            text: 'None',\r\n            attr: 'disabled'\r\n        }));\r\n\r\n        $(\"#factura\").focus();\r\n        $(\"#factura\").focusout(function () {\r\n            var id = $(this).val();\r\n            //alert(id);\r\n            $.get('/facturas/' + id)\r\n                .done(function (data) {\r\n\r\n                    if (isEmptyObject(data)) {\r\n                        alert(\"no hay datos\");\r\n                        $('#factura').val(\"\");\r\n                        $('#paciente').val(\"\");\r\n                        $('#edad').val(\"\");\r\n                        $('#edad2').val(\"\");\r\n                        $('#email').val(\"\");\r\n                        $('#direccion').val(\"\");\r\n                        $('#sexo').val(\"\");\r\n                        $('#medico').val(\"\");\r\n                        return;\r\n                    }\r\n\r\n                    if (checkItem(data.examen.item) === false) {\r\n                        $(\"#factura\").val() === \"\";\r\n                        return alert('Esta no es una Biopsia');\r\n                    }\r\n\r\n                    $('#paciente').val(data.nombre_completo_cliente);\r\n\r\n                    $('#edad').val(data.edad);\r\n\r\n                    $('#email').val(data.correo);\r\n\r\n                    $('#direccion').val(data.direccion_entrega_sede);\r\n\r\n                    $('#sexo').val(data.sexo);\r\n\r\n                    $('#medico').val(data.medico);\r\n\r\n                })\r\n                .fail(function () {\r\n                    alert(\"Problemas con el servidor\");\r\n                    $('#factura').val(\"\");\r\n                    $('#paciente').val(\"\");\r\n                    $('#edad').val(\"\");\r\n                    $('#edad2').val(\"\");\r\n                    $('#email').val(\"\");\r\n                    $('#direccion').val(\"\");\r\n                    $('#sexo').val(\"\");\r\n                    $('#medico').val(\"\");\r\n                    return;\r\n                })\r\n        })\r\n    });\r\n\r\n    $('a.bt-insert').click(function (e) {\r\n        e.preventDefault();\r\n        const id = $(this).attr(\"href\");\r\n        $.get('/plantillas/info/' + id)\r\n            .done(function (data) {\r\n                console.log(data);\r\n                CKEDITOR.instances['informe'].insertHtml(data.body);\r\n            });\r\n\r\n    });\r\n\r\n    $('#ImagesModal').on('shown.bs.modal', function (e) {\r\n        // Initialize Dropzone\r\n    });\r\n\r\n\r\n    $('#topog').inputmask(\"#99.9\");\r\n\r\n    function save(text) {\r\n\r\n        const serialize =  $(\"#myForm\").serialize();\r\n\r\n        $.ajax({\r\n            method: \"POST\",\r\n            url: \"/histipatologiaApi/store\",\r\n            data: serialize,\r\n        }).done(function (data) {\r\n            console.log(data);\r\n            toastr.success('La biopsia a sido salvada exitosamente!!', 'Registro Guardado');\r\n            window.location = '/histopatologia/ '+ Number(data.factura_id) + '/edit'\r\n        }).fail(function (data) {\r\n            console.log(data);\r\n            toastr.error('El servidor dice:  ' +data.statusText, 'Status: ' + data.status + ' -- '+ data.responseText)\r\n        });\r\n    }\r\n\r\n    $(\"#informe\").ckeditor(function () {\r\n\r\n// Once the editor is loaded, we can add custom commands\r\n\r\n        /** Alt + A will alert a greeting message **/\r\n        // First, we define our custom command\r\n        this.addCommand('myGreetingCommand', {\r\n            exec: function (editor, data) {\r\n                save(\"inside\");\r\n            }\r\n        });\r\n\r\n        // Then, we set up the key combination\r\n        this.keystrokeHandler.keystrokes[120 /* A */] = 'myGreetingCommand';\r\n\r\n        /** Ctrl + B will alert a good bye message **/\r\n        this.addCommand('myGoodByeCommand', {\r\n            exec: function (editor, data) {\r\n                save(\"inside!\");\r\n            }\r\n        });\r\n\r\n        this.keystrokeHandler.keystrokes[CKEDITOR.CTRL + 66 /* B */] = 'myGoodByeCommand';\r\n\r\n    });\r\n\r\n    document.addEventListener(\"keydown\", function (event) {\r\n        if (event.which == 120) {\r\n            save(\"outside\")\r\n        }\r\n    });\r\n\r\n    $('#myForm').submit(function (e) {\r\n        e.preventDefault();\r\n        save(\"outside\");\r\n\r\n    })\r\n\r\n})(jQuery);"]}