{"version":3,"sources":["histopatologia-form.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"histopatologia-form.js","sourcesContent":["\n(function(){\n    $.ajaxSetup({\n        headers: {\n            'X-XSRF-TOKEN': $('input[name=\"_token\"]').val()\n        }\n    });\n\n    function getDate(date){\n\n        const mydate = new Date(date);\n        const a = moment(new Date());\n        const b = moment(mydate);\n        const years = a.diff(b, 'year');\n\n        b.add(years, 'years');\n        const months = a.diff(b, 'months');\n        b.add(months, 'months');\n        const days = a.diff(b, 'days');\n\n        if(years > 0){\n            return years + ' A';\n        } else {\n            return months + ' M';\n        }\n    }\n\n    $(document).ready(function () {\n        $(\"#factura\").focusout(function () {\n            var id = $(this).val();\n            //alert(id);\n            $.get('/facturas/' + id)\n                .done(function (data) {\n                    console.log(data.nombre_completo_cliente);\n                    $('#paciente').val(data.nombre_completo_cliente);\n\n                    const fulldate =  getDate(data.fecha_nacimiento);\n\n                    $('#edad').val(fulldate);\n                    $('#edad2').val(fulldate);\n\n                    $('#email').val(data.correo);\n\n                    $('#direccion').val(data.direccion_entrega_sede);\n\n                    $('#sexo').val(data.sexo);\n\n                    $('#medico').val(data.medico);\n\n                })\n                .fail(function () {\n                    alert('failure');\n                })\n        })\n    });\n\n    $('a.bt-insert').click(function(e){\n        e.preventDefault();\n        const id = $(this).attr(\"href\");\n        $.get('/plantillas/info/' + id)\n            .done(function(data){\n                console.log(data);\n                CKEDITOR.instances['informe'].insertHtml(data.body);\n            });\n\n    });\n\n    $('#ImagesModal').on('shown.bs.modal', function (e) {\n        // Initialize Dropzone\n    });\n\n    $('.colorbox').colorbox();\n\n    $('.imageCanvas').each(function (ind, val){\n        var x = 0, y = 0;\n\n        let image   = $(this).find('.image');\n        let btnPlus = $(this).find('#changePlus');\n        let btnLess = $(this).find('#changeLess');\n        let btnSave = $(this).find('#changeSave');\n        let crf = $('input[name=\"_token\"]').val();\n        let del = $(this).find('.delete');\n\n        let id = image.prop('id');\n        let name = image.prop('alt');\n        console.log('id-' + id);\n\n\n        let classList = image.attr('class');\n        let arr = classList.split(' ');\n        let className = '.'+arr[arr.length-1];\n        console.log(className);\n\n        $(btnPlus).click(function (e) {\n            e.preventDefault();\n            btnSave.show();\n            y = (x + 5);\n\n            Caman(className, function () {\n                this.brightness(y);\n                this.render();\n            });\n        });\n\n        $(btnLess).click(function (e) {\n            e.preventDefault();\n            btnSave.show();\n            y = (x - 5);\n\n            Caman(className, function () {\n                this.brightness(y);\n                this.render();\n            });\n        });\n\n        $(btnSave).click(function(){\n            let canvas = $(className);\n            let dataUrl = canvas.get(0).toDataURL();\n            let linkId = $('input[name=\"link_id\"]').val();\n\n            $.ajax({\n                type: \"put\",\n                url: \"/histo/images/update/\" + id,\n                data: {\n                    '_token': crf,\n                    'images': dataUrl,\n                    'link_id': linkId,\n                    'name': name\n                }\n            }).done(function(response) {\n                btnSave.hide();\n                console.log(response);\n            });\n        });\n\n        $(del).on('click',function(e){\n            e.preventDefault();\n            $(this).closest(\"div\").remove();\n            $.ajax({\n                type: \"get\",\n                url:\"/histo/images/delete/\" + id\n            }).done(function(res){\n                $(this).closest(\"div\").remove();\n                console.log('read')\n            })\n        })\n\n    });\n\n    $('#topog').inputmask(\"#.9999\");\n\n    document.addEventListener(\"keydown\", function(event) {\n        if(event.which === 107){\n            if (confirm('¿Seguro que desea salir?, se perdera toda la Información no salvada!!')) {\n                window.location.href = '/citologias/create';\n            }\n        }\n\n        if(event.ctrlKey === true && event.which == 13)\n        {\n            $( \"#myForm\" ).submit();\n        }\n    });\n\n})(jQuery);"]}